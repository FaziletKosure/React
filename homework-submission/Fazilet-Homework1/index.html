<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Getting started</title>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.6/prop-types.min.js"></script>
    <script
      src="https://unpkg.com/react@16/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
      crossorigin
    ></script>
    <style>
      .crossed {
        text-decoration: line-through;
      }
      .todos {
        display: flex;
        flex-direction: row;
        justify-content: center;
        margin: 20px 20px;
        border: 5px solid red;
      }
      h1 {
        color: blue;
        text-align: center;
      }
      ul {
        list-style: none;
        align-self: auto;
        padding-left: 50px;
        margin: 20px;
      }
      .todoD {
        margin: 20px;
      }
    </style>
  </head>
  <body>
    <div id="thisIsWhereReactIsInjected"></div>
    <script type="text/babel">
      (function() {
        const todosDynamic = [
          {
            id: 1,
            description: "Get out of bed",
            deadline: "2017-09-11",
            done: false
          },
          {
            id: 2,
            description: "Brush teeth",
            deadline: "2017-09-10",
            done: false
          },
          {
            id: 3,
            description: "Eat breakfast",
            deadline: "2017-09-09",
            done: false
          }
        ];

        class AddTodo extends React.Component {
          state = {
            description: null,
            deadline: null,
            done: null
          };
          handleChange = e => {
            this.setState({
              [e.target.id]: e.target.value,
              [e.target.description]: e.target.value,
              [e.target.deadline]: e.target.value
            });
          };
          handleSubmit = e => {
            e.preventDefault();
            console.log(this.state);
            this.props.addTodo(this.state);
            this.setState({
              description: " ",
              deadline: " "
            });
          };
          render() {
            return (
              <div>
                <form onSubmit={this.handleSubmit}>
                  <label htmlFor="description">Description:</label>
                  <input
                    type="text"
                    id="description"
                    onChange={this.handleChange}
                    value={this.state.description}
                  />
                  <label htmlFor="deadline">Deadline:</label>
                  <input
                    type="text"
                    id="deadline"
                    onChange={this.handleChange}
                    value={this.state.deadline}
                  />
                  <button>Submit</button>
                </form>
              </div>
            );
          }
        }

        class Todo extends React.Component {
          state = {
            done: null
          };
          handleChange = e => {
            console.log(e.target.checked);

            this.setState({
              [e.target.id]: e.target.checked
            });
          };
          render() {
            const doneStyle = {
              textDecoration: " line-through"
            };
            console.log(this.props);
            return (
              <div>
                <ul>
                  <li
                    style={this.state.done ? doneStyle : null}
                    className={
                      "todoD " + (this.props.done ? "crossed" : "uncrossed")
                    }
                  >
                    {this.props.description}, {this.props.deadline}
                    <br />
                    <button
                      onClick={() => {
                        this.props.deleteTodo(this.props.id);
                      }}
                    >
                      Delete
                    </button>
                    <label htmlFor="done">Done:</label>
                    <input
                      type="checkbox"
                      id="done"
                      onChange={this.handleChange}
                      checked={this.state.done}
                    />
                  </li>
                </ul>
              </div>
            );
          }
        }

        class TodoList extends React.Component {
          constructor(props) {
            super(props);
            this.state = {
              todos: this.props.todos
            };
          }

          addTodo = todo => {
            todo.id = Math.random();
            let todos = [...this.state.todos, todo];
            this.setState({
              todos
            });
          };
          deleteTodo = id => {
            console.log(id);
            const todos = this.state.todos.filter(todo => {
              return todo.id !== id;
            });
            this.setState({
              todos: todos
            });
          };
          render() {
            console.log(this.props);
            return (
              <section className="todos">
                <div>
                  <h1>Todo's</h1>

                  {this.state.todos.map(todoD => (
                    <Todo
                      todos={this.state.todos}
                      key={todoD.id}
                      {...todoD}
                      deleteTodo={this.deleteTodo}
                    />
                  ))}
                </div>
                <AddTodo addTodo={this.addTodo} />
              </section>
            );
          }
        }

        ReactDOM.render(
          <TodoList todos={todosDynamic} />,
          document.getElementById("thisIsWhereReactIsInjected")
        );
      })(React, ReactDOM);
    </script>
  </body>
</html>
